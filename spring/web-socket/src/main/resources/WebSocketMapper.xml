<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.admin.websocket.mapper.WebSocketMapper">

    <!-- 分页排序查询 -->
    <select id="myPage" resultType="com.admin.websocket.model.vo.SysSysWebSocketPageVO">
        SELECT a.id,
        a.create_id,
        a.create_time,
        a.user_id,
        a.region,
        a.ip,
        a.browser,
        a.os,
        a.mobile_flag,
        a.type,
        a.server,
        a.category,
        IF(b.nickname IS NULL, '-' , b.nickname) AS userName
        FROM sys_web_socket a
        LEFT JOIN sys_user_info b ON b.user_id = a.user_id
        WHERE a.del_flag = FALSE
        <if test="dto.id != null and dto.id != ''">
            AND a.id = #{dto.id}
        </if>
        <if test="dto.userId != null and dto.userId != ''">
            AND a.user_id = #{dto.userId}
        </if>
        <if test="dto.region != null and dto.region != ''">
            AND a.region LIKE CONCAT('%', #{dto.region}, '%')
        </if>
        <if test="dto.ip != null and dto.ip != ''">
            AND a.ip LIKE CONCAT('%', #{dto.ip}, '%')
        </if>
        <if test="dto.browser != null and dto.browser != ''">
            AND a.browser LIKE CONCAT('%', #{dto.browser}, '%')
        </if>
        <if test="dto.os != null and dto.os != ''">
            AND a.os LIKE CONCAT('%', #{dto.os}, '%')
        </if>
        <if test="dto.server != null and dto.server != ''">
            AND a.server LIKE CONCAT('%', #{dto.server}, '%')
        </if>
        <if test="dto.mobileFlag != null">
            AND a.mobile_flag = #{dto.mobileFlag}
        </if>
        <if test="dto.type != null">
            AND a.type = #{dto.type}
        </if>
        <if test="dto.enableFlag != null">
            AND a.enable_flag = #{dto.enableFlag}
        </if>
        <if test="dto.category != null">
            AND a.category = #{dto.category}
        </if>
    </select>

</mapper>
